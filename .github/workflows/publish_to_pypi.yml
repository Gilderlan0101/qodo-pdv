# Nome do fluxo de trabalho (aparece na aba 'Actions' do GitHub)
name: Publicar no PyPI

# Define quando este fluxo de trabalho serÃ¡ executado
on:
  # Executa sempre que um novo 'release' for criado
  release:
    types: [published]
  # Permite executar manualmente
  workflow_dispatch:

# PermissÃµes necessÃ¡rias para o trabalho de deploy
permissions:
  contents: read
  id-token: write

jobs:
  # O trabalho principal para construir e fazer o deploy
  deploy:
    runs-on: ubuntu-latest
    environment:
      name: pypi
      url: https://pypi.org/p/qodo

    steps:
    - name: â¬‡ï¸ Checkout do cÃ³digo
      uses: actions/checkout@v4

    - name: âš™ï¸ Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: ğŸ› ï¸ Instalar dependÃªncias de build
      run: |
        python -m pip install --upgrade pip
        pip install build setuptools wheel twine

    - name: ğŸ—ï¸ Construir o pacote
      run: python -m build

    - name: ğŸ“¦ Publicar no PyPI
      uses: pypa/gh-action-pypi-publish@release
      with:
        user: __token__
        password: ${{ secrets.PYPI_API_TOKEN }}